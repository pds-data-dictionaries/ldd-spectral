<?xml version="1.0" encoding="UTF-8"?>

<!--This test label exercises:
        o Array_1D_Spectrum (under <File_Area_Observational>) rules, so that a value of '1D' is permitted in <sp:Spectral_Characteristics>.sp:spectrum_format>
          and so a spectrum_format of '1D' is permitted with Array_1D_Spectrum-type (and not just table-type) objects.
    NOTE: Specific Schema/trons not added in label – they get added by GitHub Action pipeline)
-->

<Product_Observational
    xmlns="http://pds.nasa.gov/pds4/pds/v1"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:sp="http://pds.nasa.gov/pds4/sp/v1">

    <Identification_Area>
        <logical_identifier>urn:nasa:pds:bundle:collection:product</logical_identifier>
        <version_id>1.0</version_id>
        <title>Test label for Array_1D_Spectrum – Fail </title>
        <information_model_version>[IM VERSION]</information_model_version>
        <product_class>Product_Observational</product_class>
    </Identification_Area>
    <Observation_Area>
        <Time_Coordinates>
            <start_date_time>2000-11-07T20:47:16.014Z</start_date_time>
            <stop_date_time>2000-11-07T20:49:16.014Z</stop_date_time>
        </Time_Coordinates>
        <Primary_Result_Summary>
            <purpose>Science</purpose>
            <processing_level>Raw</processing_level>
            <Science_Facets>
                <wavelength_range>Ultraviolet</wavelength_range>
                <discipline_name>Spectroscopy</discipline_name>
                <facet1>Linear</facet1>
            </Science_Facets>
        </Primary_Result_Summary>
        <Investigation_Area>
            <name>Cassini-Huygens</name>
            <type>Mission</type>
            <Internal_Reference>
                <lid_reference>urn:nasa:pds:context:investigation:mission.cassini-huygens</lid_reference>
                <reference_type>data_to_investigation</reference_type>
            </Internal_Reference>
        </Investigation_Area>
        <Observing_System>
            <name>Cassini Orbiter Ultraviolet Imaging Spectrograph</name>
            <Observing_System_Component>
                <name>Cassini Orbiter</name>
		<type>Host</type>
                <Internal_Reference>
                    <lid_reference>urn:nasa:pds:context:instrument_host:spacecraft.co</lid_reference>
                    <reference_type>is_instrument_host</reference_type>
                </Internal_Reference>
            </Observing_System_Component>
            <Observing_System_Component>
                <name>Ultraviolet Imaging Spectrograph</name>
                <type>Instrument</type>
                <description>UVIS</description>
                <Internal_Reference>
                    <lid_reference>urn:nasa:pds:context:instrument:uvis.co</lid_reference>
                    <reference_type>is_instrument</reference_type>
                </Internal_Reference>
            </Observing_System_Component>
        </Observing_System>
        <Target_Identification>
            <name>Solar Wind</name>
            <type>Plasma Stream</type>
            <Internal_Reference>
                <lid_reference>urn:nasa:pds:context:target:plasma_stream.solar_wind</lid_reference>
                <reference_type>data_to_target</reference_type>
            </Internal_Reference>
        </Target_Identification>
        <Discipline_Area>
            <sp:Spectral_Characteristics>
                <Local_Internal_Reference>
                    <local_identifier_reference>spectrum</local_identifier_reference>
                    <local_reference_type>spectral_characteristics_to_array_object</local_reference_type> <!-- MJTM: Since changed from Table_Binary below to Array_1D_Spectrum, have to change 'spectral_characteristics_to_table_object' -->
                </Local_Internal_Reference>
                <sp:spectrum_format>2D</sp:spectrum_format> <!--MJTM: testing this shouldn't work with Array_1D_Spectrum -->
                <sp:value_field_name>Raw Data Number</sp:value_field_name>
                <sp:spectral_bin_type>wavelength</sp:spectral_bin_type>
                <sp:Field_of_View>
                    <sp:description>
                        There is no optical distortion in the detector, so the pointing geometry of any pixel
                        on the detector can be computed from these numbers and the location of the center of the
                        detector.
                    </sp:description>
                    <sp:Rectangular_FOV>
                        <sp:width_angle unit="mrad">60.</sp:width_angle>
                        <sp:length_angle unit="mrad">1.</sp:length_angle>
                    </sp:Rectangular_FOV>
                    <Internal_Reference>
                        <lid_reference>urn:nasa:pds:cassini_documents:uvis:uvis_instrument_description_catalog</lid_reference>
                        <reference_type>spectral_characteristics_to_document</reference_type>
                    </Internal_Reference>
                </sp:Field_of_View>
                <sp:Bin_Description>
                    <sp:bin_profile_description>
                        Most UVIS EUV/FUV data files consist of a 3-D array with two spatial dimensions (Sample, Line) and one
                        spectral dimension (Band). The array represents a time series of 2-D (spectral x spatial) arrays. Each
                        array contains the number of counts received by the detector during a fixed time interval, which is
                        specified by the integration_duration attribute. If the 2-D array has a Line magnitude of 1, then the
                        array is effectively a time series of 1-D spectra. If the array also has a Sample magnitude of 1, then
                        it is a single 1-D spectrum. The region(s) of the detector in which data was taken is defined by the
                        Detector_Window class.
                        Refer to UVIS User's Guide for further details.
                    </sp:bin_profile_description>
                    <sp:Spectral_Lookup>
                        <sp:Bin_Center_Lookup>
                            <Internal_Reference>
                                <lid_reference>urn:nasa:pds:cassini_uvis_euvfuv_saturn:document:euv-wavelength-bin-centers</lid_reference>
                                <reference_type>spectral_characteristics_to_bin_center_values</reference_type>
                                <comment>
                                    This file contains wavelength bin center values that were extracted from the PDS3 labels of the calibration files.
                                    The values are the same for every EUV data product so they are captured in a single file.
                                </comment>
                            </Internal_Reference>
                        </sp:Bin_Center_Lookup>
			            <sp:Bin_Width_Lookup> <!-- Required by Spectral dictionary -->
                            <Internal_Reference>
                                <lid_reference>urn:nasa:pds:cassini_uvis_euvfuv_saturn:document:euv-wavelength-bin-widths</lid_reference>
                                <reference_type>spectral_characteristics_to_bin_width_values</reference_type>
                                <comment>
                                    Wavelength bin widths were not provided with the original PDS3 data set.
                                    If this information becomes available, we will place it in the indicated file and update this comment.
                                </comment>
                            </Internal_Reference>
                        </sp:Bin_Width_Lookup>
                  </sp:Spectral_Lookup>
                </sp:Bin_Description>
            </sp:Spectral_Characteristics>
        </Discipline_Area>
    </Observation_Area>
    <Reference_List>
        <Internal_Reference>
	    <lid_reference>urn:nasa:pds:misc:document_cassini:pds3_cassini_uvis_ug_20180706</lid_reference>
            <reference_type>data_to_document</reference_type>
            <comment>The Cassini UVIS User's Guide (PDS3); DOI: 10.17189/1522470</comment>
        </Internal_Reference>
	<External_Reference>
            <doi>10.1007/s11214-004-1455-8</doi>
            <reference_text>
                Esposito, L. W. et al., The Cassini Ultraviolet Imaging Spectrograph Investigation,
                Space Science Reviews, Volume 115: Issue 1-4, pp. 299-361, 2004.
            </reference_text>
        </External_Reference>
    </Reference_List>
    <File_Area_Observational>
        <File>
            <file_name>No.Data</file_name>
        </File>
<!-- The Spectrum -->
        <Array_1D_Spectrum> <!-- MJTM: testing this – changed from Table_Binary, also needed to change <sp:Spectral_Characteristics> above -->
            <name>Spectrum</name>
            <local_identifier>spectrum</local_identifier>
            <offset unit="byte">0</offset>
            <axes>1</axes>
            <axis_index_order>Last Index Fastest</axis_index_order>
            <description>  <!--DESCRIPTION from the original PDS3 label--> 
                    This SPECTRUM is stored as a
              one column table with 1024 rows where each row contains a sample
              of the spectrum. Each sample contains counts taken from a set
              of detector columns. The mapping of sample to detector columns
              is defined by the binning and windowing of the detector. All
              counts were accumulated during 120 second time intervals.
                    The purpose of this observation is to measure the HeI 584A and HI
                Lyman Series emissions from the interplanetary/local interstellar
                medium, while S/C is downlinking S/C may be rotating or
                not-rotating.
            </description>
            <Element_Array>
                <data_type>UnsignedMSB2</data_type>
                <unit>counts per integration</unit> <!-- Note: Array_3D_Spectrum says "counts per bin" -->
                <scaling_factor>1.0</scaling_factor>  <!--Equivalent to PDS3 keyword CORE_MULTIPLIER; value is always 1.-->
                <value_offset>0.0</value_offset>      <!--Equivalent to PDS3 keyword CORE_BASE; value is always 0.-->
            </Element_Array>
            <Axis_Array>
                <axis_name>Band</axis_name> 
                <elements>1024</elements>
                <sequence_number>1</sequence_number>
            </Axis_Array>
            <Special_Constants>
                <missing_constant>65535</missing_constant>
            </Special_Constants>
        </Array_1D_Spectrum>
    </File_Area_Observational>
</Product_Observational>
